!function(e){var r={};function __webpack_require__(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}__webpack_require__.m=e,__webpack_require__.c=r,__webpack_require__.d=function(e,r,t){__webpack_require__.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,r){if(1&r&&(e=__webpack_require__(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(__webpack_require__.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)__webpack_require__.d(t,a,function(r){return e[r]}.bind(null,a));return t},__webpack_require__.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(r,"a",r),r},__webpack_require__.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,r,t){"use strict";t.r(r);const a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],o=(e,r)=>{var t="";for(let o=1;o<=r;o++){let n=Math.floor(e)/Math.pow(83,r-o)%83;t+=a[Math.floor(n)]}return t},n=e=>{let r=e/255;return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)},_=e=>{let r=Math.max(0,Math.min(1,e));return r<=.0031308?Math.round(12.92*r*255+.5):Math.round(255*(1.055*Math.pow(r,1/2.4)-.055)+.5)},i=(e,r)=>(e<0?-1:1)*Math.pow(Math.abs(e),r);class ValidationError extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}}const u=(e,r,t,a)=>{let o=0,_=0,i=0;const u=4*r;for(let c=0;c<r;c++)for(let r=0;r<t;r++){const t=a(c,r);o+=t*n(e[4*c+0+r*u]),_+=t*n(e[4*c+1+r*u]),i+=t*n(e[4*c+2+r*u])}let c=1/(r*t);return[o*c,_*c,i*c]};var c=(e,r,t,a,n)=>{if(a<1||a>9||n<1||n>9)throw new ValidationError("BlurHash must have between 1 and 9 components");if(r*t*4!==e.length)throw new ValidationError("Width and height must match the pixels array");let c=[];for(let o=0;o<n;o++)for(let n=0;n<a;n++){const a=0==n&&0==o?1:2,_=u(e,r,t,((e,_)=>a*Math.cos(Math.PI*n*e/r)*Math.cos(Math.PI*o*_/t)));c.push(_)}const l=c[0],h=c.slice(1);let s,p="";if(p+=o(a-1+9*(n-1),1),h.length>0){let e=Math.max(...h.map((e=>Math.max(...e)))),r=Math.floor(Math.max(0,Math.min(82,Math.floor(166*e-.5))));s=(r+1)/166,p+=o(r,1)}else s=1,p+=o(0,1);var f;return p+=o((_((f=l)[0])<<16)+(_(f[1])<<8)+_(f[2]),4),h.forEach((e=>{p+=o(((e,r)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*i(e[0]/r,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*i(e[1]/r,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*i(e[2]/r,.5)+9.5)))))(e,s),2)})),p};self.onmessage=function(e){const{image:r,width:t,height:a,componentX:o,componentY:n}=e.data;try{const e=c(r,t,a,o,n);postMessage({type:"success",blurHash:e})}catch(e){postMessage({type:"error",error:e})}}}]);